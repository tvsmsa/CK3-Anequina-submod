##############
# ANEQUINA FLAVOR #
##############

#Restore Anequina - need entire northern Elsweyr
restore_anequina_decision = {
    picture = "gfx/interface/illustrations/decisions/decision_realm.dds"
    desc = restore_anequina_decision_desc
    selection_tooltip = restore_anequina_decision_tooltip
    major = yes

    ai_check_interval = 120

    is_shown = {
		is_ruler = yes
		is_landed = yes
		NOT = { has_title = title:e_elsweyr }
		has_feudal_like_government = yes
        culture = culture:anequinan
        NOT = { has_global_variable = anequina_restored }
	}

    is_valid = {
        is_independent_ruler =  yes
        is_at_war = no
        prestige_level >= 4
		OR = {
			has_primary_title = title:k_anequina
			has_primary_title = title:k_rimmen
            has_primary_title = title:k_orcrest
            has_primary_title = title:k_riverhold
		}
		completely_controls_region = mundus_tamriel_elsweyr_anequina
	}

    cost = {
		prestige = { value = 1500 }
		gold = { value = 500 }
	}

    effect = {
		#Get Empire of Anequina
		get_title = title:e_anequina
		#Event for Restoration
		trigger_event = anequina.0001
        custom_tooltip = restore_anequina_decision_effect_tooltip
        add_character_modifier = {
			modifier = restored_anequina_modifier
			years = 50
		}
        hidden_effect = {
            title:k_rimmen = { save_scope_as = anequina_rimmen }
            title:k_orcrest = { save_scope_as = anequina_orcrest }
            title:k_riverhold = { save_scope_as = anequina_riverhold }
            title:k_dune = { save_scope_as = anequina_dune }
            title:k_rimmen = { set_de_jure_liege_title = title:e_anequina }
            title:k_orcrest = { set_de_jure_liege_title = title:e_anequina }
            title:k_riverhold = { set_de_jure_liege_title = title:e_anequina }
            title:k_dune = { set_de_jure_liege_title = title:e_anequina }
		}
        set_global_variable = anequina_restored
	}

    ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

#Integrate Leyawiin
integrate_leyawiin_decision = {
    picture = "gfx/interface/illustrations/decisions/ai_decision_title_drift.dds"
    desc = integrate_leyawiin_decision_desc
    selection_tooltip = integrate_leyawiin_decision_tooltip
    major = yes

    ai_check_interval = 120

    is_shown = {
		is_ruler = yes
		is_landed = yes
		has_title = title:e_anequina
        culture = culture:anequinan
        has_global_variable = anequina_restored
        NOT = { has_global_variable = leyawiin_integrated }
	}

    is_valid = {
        is_at_war = no
        prestige_level >= 4
        completely_controls = title:d_nomore
        completely_controls = title:d_leyawiin
	}

    cost = {
        gold = { value = 500 }
    }

    effect = {
        get_title = title:k_leyawiin
        custom_tooltip = integrate_leyawiin_decision_effect_tooltip
        trigger_event = anequina.0002
        title:k_leyawiin = { set_de_jure_liege_title = title:e_anequina }
        set_global_variable = leyawiin_integrated
    }

    ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

#Return Arenthia 
return_arenthia_decision = {
    picture = "gfx/interface/illustrations/decisions/ai_decision_title_drift.dds"
    desc = return_arenthia_decision_desc
    selection_tooltip = return_arenthia_decision_tooltip
    major = yes

    ai_check_interval = 120

    is_shown = {
		is_ruler = yes
		is_landed = yes
		has_title = title:e_anequina
        culture = culture:anequinan
        has_global_variable = anequina_restored
        NOT = { has_global_variable = arenthia_returned }
	}

    is_valid = {
        is_at_war = no
        prestige_level >= 4
        #Need to fully control and have held title of Arenthia for 15 years
        completely_controls = title:k_arenthia
        has_title = title:k_arenthia
        title:k_arenthia = { title_held_years >= 15 }
        #Need capital of Arenthia to be of your culture
        title:c_arenthia.culture = root.culture
	}

    cost = {
        gold = { value = 500 }
    }

    effect = {
        custom_tooltip = return_arenthia_decision_effect_tooltip
        add_character_modifier = {
            modifier = returned_arenthia_modifier
            years = 50
        }
        trigger_event = anequina.0003
        title:k_arenthia = { set_de_jure_liege_title = title:e_anequina }
        set_global_variable = arenthia_returned
    }
    ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

#Restore Darloc Brae's Kingdom
restore_darloc_kingdom_decision = {
    picture = "gfx/interface/illustrations/decisions/ai_decision_title_drift.dds"
    desc = restore_darloc_kingdom_decision_desc
    selection_tooltip = restore_darloc_kingdom_decision_tooltip
    major = yes

    ai_check_interval = 120

    is_shown = {
		is_ruler = yes
		is_landed = yes
		has_title = title:e_anequina
        culture = culture:anequinan
        has_global_variable = anequina_restored
        NOT = { has_global_variable = restored_darloc_kingdom }
	}

    is_valid = {
        #High prestige and high piety
        prestige_level >= 4
        piety_level >= 3
        #Need to fully conquer Leyawiin
        completely_controls = title:k_leyawiin
        #Need high dev in newly conquered counties or other culture
        OR = {
            title:c_leyawiin = {
                development_level >= 20
            }
            title:c_leyawiin.culture = culture:nibenese
            title:c_leyawiin.culture = culture:malapiit
        }
        OR = {
            title:c_sleekcreek = {
                development_level >= 20
            }
            title:c_arenthia = {
                development_level >= 20
            }
        }
        #You can't do this after just inheriting the throne. Shouldn't be a problem for character who was ruling for a while. Comment for testing
        #title:e_anequina = { title_held_years >= 15 }
    }

    effect = {
        #custom_tooltip = restore_darloc_kingdom_decision_effect_tooltip
        give_nickname = nick_darloc_brae_reborn
        add_character_modifier = restored_darloc_kingdom_modifier
        trigger_event = anequina.0004
        set_global_variable = restored_darloc_kingdom
    }

    ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

#Conquer Skingrad 
conquer_skingrad_decision = {
    picture = "gfx/interface/illustrations/decisions/ai_decision_title_drift.dds"
    desc = conquer_skingrad_decision_desc
    selection_tooltip = conquer_skingrad_decision_tooltip
    major = yes

    ai_check_interval = 120

    is_shown = {
		is_ruler = yes
		is_landed = yes
		has_title = title:e_anequina
        OR = {
            has_global_variable = anequina_cyrodiil_expansion
            has_global_variable = reunited_elsweyr
        }
        NOT = { has_global_variable = conquered_skingrad }
	}

    is_valid = {
        is_at_war = no
        prestige_level >= 3
        #Need to fully control Skingrad
        completely_controls = title:k_skingrad
        #Need holders of Skingrads to have positive opinion
        title:k_skingrad.holder = {
			opinion = {
				target = root
				value >= high_positive_opinion
			}
		}
        title:d_skingrad.holder = {
			opinion = {
				target = root
				value >= high_positive_opinion
			}
		}
        title:c_skingrad.holder = {
			opinion = {
				target = root
				value >= high_positive_opinion
			}
		}
	}

    effect = {
        #custom_tooltip = conquer_skingrad_decision_effect_tooltip
        title:k_skingrad = { set_de_jure_liege_title = title:e_anequina }
        set_global_variable = conquered_skingrad
    }
    ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

#Shatter Mane's Realm (base game dismantle HRE decision) NEED TO FIX CB
dismantle_mane_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_realm.dds"

	desc = dismantle_mane_decision_desc
	selection_tooltip = dismantle_mane_decision_tooltip
	major = yes

	ai_check_interval = 120

	is_shown = {
		exists = title:e_elsweyr.holder #Must exist in the first place...
		NOT = {
			root = title:e_elsweyr.holder #That'd be awkward...
		}
		is_ruler = yes
		is_landed = yes
		has_title = title:e_anequina
		NOT = { #Once an Emperor throws the challenge, he has only one chance to dismantle the Empire.
            has_character_flag = flag_anequina_challenging_mane
		}
        OR = {
            has_global_variable = anequina_south_expansion
            has_global_variable = claimed_cyrodiil
        }
	}

	is_valid = {
        prestige_level >= 3
		piety_level >= 5
		#Control Anequina and then either Alabaster or Cyrodiil
		completely_controls_region = mundus_tamriel_elsweyr_anequina
        OR = {
            completely_controls_region = mundus_tamriel_cyrodiil
            completely_controls = title:k_alabaster
        }
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_independent_ruler = yes
		is_at_war = no
	}

	cost = {
		prestige = 1000
        piety = 2000
	}

	effect = {
		custom_tooltip = dismantle_mane_decision_effect_tooltip
        add_piety_level = -1
		trigger_event = anequina.0005
	}
	
	ai_potential = {
        NOT = {
            has_trait = zealous
        }
	}

	ai_will_do = { base = 100 }
}

#Unite Elsweyr under Anequina
unite_elsweyr_anequina_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_realm.dds"

	desc = unite_elsweyr_anequina_decision_desc
	selection_tooltip = unite_elsweyr_anequina_decision_tooltip
	major = yes

	ai_check_interval = 120

	is_shown = {
		is_ruler = yes
		is_landed = yes
		has_title = title:e_anequina
        NOT = {has_global_variable = reunited_elsweyr}
        OR = {
            has_global_variable = anequina_south_expansion
            has_global_variable = claimed_cyrodiil
        }
	}

	is_valid = {
		#Control Elsweyr and have both titles
		completely_controls_region = mundus_tamriel_elsweyr
        has_title = title:e_anequina
        has_title = title:e_elsweyr
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_independent_ruler = yes
		is_at_war = no
	}

	effect = {
		custom_tooltip = unite_elsweyr_anequina_decision_effect_tooltip
        title:k_alabaster = { set_de_jure_liege_title = title:e_anequina }
        title:k_corinthe = { set_de_jure_liege_title = title:e_anequina }
        title:k_senchal = { set_de_jure_liege_title = title:e_anequina }
        title:k_torval = { set_de_jure_liege_title = title:e_anequina }
		set_global_variable = reunited_elsweyr
	}
	
	ai_potential = {
        always = yes
	}

	ai_will_do = { base = 100 }
}

#Invade Heartlands after conquering Bravil or Chorrol
invade_heartlands_decision = {
    picture = "gfx/interface/illustrations/decisions/ai_decision_title_drift.dds"

	desc = invade_heartlands_decision_desc
	selection_tooltip = invade_heartlands_decision_tooltip
	major = yes

	ai_check_interval = 120

	is_shown = {
		is_ruler = yes
		is_landed = yes
		has_title = title:e_anequina
        NOT = {has_global_variable = invaded_heartlands}
        #Need to conquer Skingrad first
        has_global_variable = conquered_skingrad
	}

	is_valid = {
		#Control Either chorrol or bravil
        OR = {
            completely_controls = title:k_chorrol
            completely_controls = title:k_bravil
        }
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_independent_ruler = yes
		is_at_war = no
	}

	effect = {
		custom_tooltip = invade_heartlands_decision_effect_tooltip
        add_pressed_claim = title:k_heartlands
		set_global_variable = invaded_heartlands
	}
	
	ai_potential = {
        always = yes
	}

	ai_will_do = { base = 100 }
}

claim_cyrodiil_decision = {
    picture = "gfx/interface/illustrations/decisions/ai_decision_title_drift.dds"

	desc = claim_cyrodiil_decision_desc
	selection_tooltip = claim_cyrodiil_decision_tooltip
	major = yes

	ai_check_interval = 120

	is_shown = {
		is_ruler = yes
		is_landed = yes
		has_title = title:e_anequina
        NOT = {has_global_variable = claimed_cyrodiil}
        #Need to conquer Heartlands first
        has_global_variable = invaded_heartlands
	}

    is_valid = {
        #Control Heartlands, Skingrad and then 3 out of other Cyrodiilian kingdoms
        completely_controls = title:k_heartlands
        completely_controls = title:k_skingrad
        completely_controls = title:k_chorrol
        completely_controls = title:k_bravil
        completely_controls = title:d_cropsford
        OR = {
            completely_controls = title:k_kvatch
            completely_controls = title:k_cheydinhal
            completely_controls = title:k_bruma
        }
    }

    cost = {
		prestige = 1000
        gold = 600
	}

    effect = {
        get_title = title:e_cyrodiil
        set_global_variable = claimed_cyrodiil
    }

    ai_potential = {
        always = yes
	}

	ai_will_do = { base = 100 }
}

reform_two_moons_decision = {
    picture = "gfx/interface/illustrations/decisions/decision_major_religion.dds"

	desc = reform_two_moons_decision_desc
	selection_tooltip = reform_two_moons_decision_tooltip
	major = yes

	ai_check_interval = 120

	is_shown = {
		is_ruler = yes
		is_landed = yes
		has_title = title:e_anequina
        NOT = {has_global_variable = reformed_two_moons}
        #Need to fully control Cyrodiil and Elsweyr
        has_global_variable = claimed_cyrodiil
        has_global_variable = reunited_elsweyr
	}

    is_valid = {
        #Control Cyrodiil and Elsweyr, very high piety
        completely_controls_region = mundus_tamriel_cyrodiil
        completely_controls_region = mundus_tamriel_elsweyr
        piety_level >= 5
        prestige_level >=5
        has_realm_law = crown_authority_3
        NOT = { has_trait = zealous }
        OR = {
            has_trait = ambitious
            has_trait = cynical
        } 
    }

    cost = {
		prestige = 3000
        piety = 4000
	}

    effect = {
        faith = {
                remove_doctrine = doctrine_theocracy_temporal
                add_doctrine = doctrine_theocracy_lay_clergy
                remove_doctrine = doctrine_mystical_birthright_head
                add_doctrine = doctrine_temporal_head
        }
        #get_title = title:d_mane
        #title:d_mane = {
        #    remove_title_law = mbhof_succession_law
        #    add_title_law = partition_succession_law
        #}
        get_title = title:d_mane
        #destroy_title = title:d_mane
        set_global_variable = reformed_two_moons
    }

    ai_potential = {
        always = yes
	}

	ai_will_do = { base = 100 }
}