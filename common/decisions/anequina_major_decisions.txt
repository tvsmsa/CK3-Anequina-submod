##############
# ANEQUINA FLAVOR #
##############

#Restore Anequina - need entire northern Elsweyr
restore_anequina_decision = {
    picture = "gfx/interface/illustrations/decisions/decision_realm.dds"
    desc = restore_anequina_decision_desc
    selection_tooltip = restore_anequina_decision_tooltip
    major = yes

    ai_check_interval = 120

    is_shown = {
		is_ruler = yes
		is_landed = yes
		NOT = { has_title = title:e_elsweyr }
		has_feudal_like_government = yes
        OR = {
            culture = culture:anequinan
            culture = { any_parent_culture_or_above = { this = culture:anequinan }}
        }
        NOT = {
            is_target_in_global_variable_list = {
                name = unavailable_unique_decisions
                target = flag:anequina_restored
            } 
        }
	}

    is_valid = {
        is_independent_ruler =  yes
        is_at_war = no
        prestige_level >= 3
		OR = {
			has_primary_title = title:k_anequina
			has_primary_title = title:k_rimmen
            has_primary_title = title:k_orcrest
            has_primary_title = title:k_riverhold
            has_primary_title = title:k_dune
		}
		completely_controls_region = mundus_tamriel_elsweyr_anequina
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_available = yes
        is_at_war = no
        is_imprisoned = no
	}
    cost = {
		prestige = 1500 
		gold = 500 
	}

    effect = {
        save_scope_as = founder
		#Get Empire of Anequina
		get_title = title:e_anequina
		#Event for Restoration
		trigger_event = anequina.0001
        custom_tooltip = restore_anequina_decision_effect
        add_character_modifier = {
			modifier = restored_anequina_modifier
			years = 50
		}
        hidden_effect = {
            title:k_rimmen = { set_de_jure_liege_title = title:e_anequina }
            title:k_orcrest = { set_de_jure_liege_title = title:e_anequina }
            title:k_riverhold = { set_de_jure_liege_title = title:e_anequina }
            title:k_dune = { set_de_jure_liege_title = title:e_anequina }
		}
        add_to_global_variable_list = {
            name = unavailable_unique_decisions
            target = flag:anequina_restored
        }
	}

    ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

#Integrate Leyawiin
integrate_leyawiin_decision = {
    picture = "gfx/interface/illustrations/decisions/ai_decision_title_drift.dds"
    desc = integrate_leyawiin_decision_desc
    selection_tooltip = integrate_leyawiin_decision_tooltip
    major = yes

    ai_check_interval = 120

    is_shown = {
		is_ruler = yes
		is_landed = yes
		has_title = title:e_anequina
        OR = {
            culture = culture:anequinan
            culture = { any_parent_culture_or_above = { this = culture:anequinan }}
        }
        has_global_variable = anequina_restored
        NOT = { has_global_variable = leyawiin_integrated }
	}

    is_valid = {
        is_at_war = no
        prestige_level >= 4
        completely_controls = title:d_nomore
        completely_controls = title:d_leyawiin
	}

    cost = {
        gold = { value = 500 }
    }

    effect = {
        get_title = title:k_leyawiin
        custom_tooltip = integrate_leyawiin_decision_effect_tooltip
        trigger_event = anequina.0002
        title:k_leyawiin = { set_de_jure_liege_title = title:e_anequina }
        set_global_variable = leyawiin_integrated
    }

    ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

#Return Arenthia 
return_arenthia_decision = {
    picture = "gfx/interface/illustrations/decisions/ai_decision_title_drift.dds"
    desc = return_arenthia_decision_desc
    selection_tooltip = return_arenthia_decision_tooltip
    major = yes

    ai_check_interval = 120

    is_shown = {
		is_ruler = yes
		is_landed = yes
		has_title = title:e_anequina
        OR = {
            culture = culture:anequinan
            culture = { any_parent_culture_or_above = { this = culture:anequinan }}
        }
        has_global_variable = anequina_restored
        NOT = { has_global_variable = arenthia_returned }
	}

    is_valid = {
        is_at_war = no
        prestige_level >= 3
        #Need to fully control and have held title of Arenthia for 15 years
        completely_controls = title:k_arenthia
        has_title = title:k_arenthia
        #title:k_arenthia = { title_held_years >= 15 }
        #Need capital of Arenthia to be of your culture
        title:c_arenthia.culture = root.culture
	}

    cost = {
        gold = { value = 500 }
    }

    effect = {
        custom_tooltip = return_arenthia_decision_effect_tooltip
        add_character_modifier = {
            modifier = returned_arenthia_modifier
            years = 50
        }
        trigger_event = anequina.0003
        title:k_arenthia = { set_de_jure_liege_title = title:e_anequina }
        set_global_variable = arenthia_returned
    }
    ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

#Restore Darloc Brae's Kingdom
restore_darloc_kingdom_decision = {
    picture = "gfx/interface/illustrations/decisions/ai_decision_title_drift.dds"
    desc = restore_darloc_kingdom_decision_desc
    selection_tooltip = restore_darloc_kingdom_decision_tooltip
    major = yes

    ai_check_interval = 120

    is_shown = {
		is_ruler = yes
		is_landed = yes
		has_title = title:e_anequina
        OR = {
            culture = culture:anequinan
            culture = { any_parent_culture_or_above = { this = culture:anequinan }}
        }
        has_global_variable = anequina_restored
        NOT = { has_global_variable = restored_darloc_kingdom }
	}

    is_valid = {
        #High prestige and high piety
        prestige_level >= 4
        piety_level >= 3
        #Need to fully control Anequina
        completely_controls_region = mundus_tamriel_elsweyr_anequina
        #Need to fully conquer Leyawiin and Arenthia
        completely_controls = title:k_leyawiin
        completely_controls = title:k_arenthia
        #Need high dev in newly conquered counties or other culture
        OR = {
            title:c_leyawiin = {
                development_level >= 20
            }
            title:c_leyawiin.culture = culture:nibenese
            title:c_leyawiin.culture = culture:malapiit
        }
        OR = {
            title:c_sleekcreek = {
                development_level >= 15
            }
            title:c_arenthia = {
                development_level >= 15
            }
        }
        #You can't do this after just inheriting the throne. Shouldn't be a problem for character who was ruling for a while. Comment for testing
        #title:e_anequina = { title_held_years >= 15 }
    }

    effect = {
        save_scope_as = founder
        #custom_tooltip = restore_darloc_kingdom_decision_effect_tooltip
        give_nickname = nick_darloc_brae_reborn
        dynasty = {
            add_dynasty_modifier = { modifier = restored_darloc_kingdom_modifier }
        }
        trigger_event = anequina.0004
        set_global_variable = restored_darloc_kingdom
    }

    ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

#Return Arenthia Bosmer version
return_arenthia_bosmer_decision = {
    picture = "gfx/interface/illustrations/decisions/ai_decision_title_drift.dds"

	desc = return_arenthia_bosmer_decision_desc
	selection_tooltip = return_arenthia_bosmer_decision_tooltip
	major = yes

	ai_check_interval = 120
    is_shown = {
        is_ruler = yes
		is_landed = yes
        culture = { has_cultural_pillar = heritage_bosmeri }
        NOT = { title:e_valenwood = { is_de_jure_liege_or_above_target = title:k_arenthia } }
    }

    is_valid = {
        completely_controls = title:k_arenthia
        #title:c_arenthia.culture = { has_cultural_pillar = heritage_bosmeri }
        OR = {
            title:c_arenthia.culture = root.culture
            title:c_arenthia.culture = culture:arenthi
            title:c_arenthia.culture = culture:bosmer
        }
        title:c_arenthia = { development_level >= 10 }
    }

    effect = {
        custom_tooltip = return_arenthia__bosmer_decision_effect_tooltip
        title:k_arenthia = { set_de_jure_liege_title = title:e_valenwood }
        add_character_modifier = returned_arenthia_bosmer_modifier
    }

    ai_potential = {
        always = yes
	}

	ai_will_do = { base = 100 }
}

#Return Leyawiin for Imperials
return_leyawiin_imperial_decision = {
    picture = "gfx/interface/illustrations/decisions/ai_decision_title_drift.dds"

	desc = return_leyawiin_imperial_decision_desc
	selection_tooltip = return_leyawiin_imperial_decision_tooltip
	major = yes

	ai_check_interval = 120
    is_shown = {
        is_ruler = yes
		is_landed = yes
        culture = { has_cultural_pillar = heritage_cyrodiilic }
        NOR = { 
            title:e_nibenay = { is_de_jure_liege_or_above_target = title:k_leyawiin }
            title:e_cyrodiil = { is_de_jure_liege_or_above_target = title:k_leyawiin} 
        }
    }

    is_valid = {
        completely_controls = title:k_leyawiin
        OR = {
            has_title = title:e_nibenay
            has_title = title:e_cyrodiil
        }
        NOT = { title:c_leyawiin.culture = culture:anequinan }
    }

    effect = {
        custom_tooltip = return_leyawiin_imperial_decision_effect_tooltip
        if = {
            limit = {
                exists = title:e_nibenay.holder #Must exist in the first place
            }
            title:k_leyawiin = { set_de_jure_liege_title = title:e_nibenay}
        }
        if = {
            limit = {
                exists = title:e_cyrodiil.holder
            }
            title:k_leyawiin = { set_de_jure_liege_title = title:e_cyrodiil }
        }
    }

    ai_potential = {
        always = yes
	}

	ai_will_do = { base = 100 }
}